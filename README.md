# Semi-supervised learning with Noisy Students improves domain generalization in optic disc and cup segmentation in uncropped fundus images
by Eugenia Moris, Ignacio Larrabide and Jose Ignacio Orlando

## Abstract

<p align="justify">
Automated optic disc (OD) and cup (OC) segmentation in fundus images has been widely explored for computer-aided diagnosis of glaucoma. 
However, existing models usually suffer from drops in performance when applied on images significantly different than those used for training.
Several domain generalization strategies have been introduced to mitigate this issue, although they are trained and evaluated using images manually cropped around the optic nerve head. 
This operation eliminates most sources of domain variation, therefore overestimating their actual ability to cope with new, unseen patterns. 
In this paper, we analyze the most recent and accurate methods for domain generalization in OD/OC segmentation by applying them on uncropped fundus pictures, observing notorious degradations in their performance when trained and evaluated under this setting.
To overcome their drawbacks, we also introduce a simple semi-supervised learning approach for domain generalization based on the Noisy Student framework.
Using a Teacher model trained on a combination of domains, we pseudo-labeled a dataset of 18.000 originally unlabeled images that are then used for training a Student model.
This semi-supervised setting allowed the Student network to capture additional sources of variability while retaining the original cues and patterns used by the Teacher through the weak annotations.
Our results on eight different public datasets show improvements in every unseen domain over all alternative methods.
</p>


![Alt text](https://github.com/eugeniaMoris/Noisy_student_ODOC_MIDL_2024/blob/main/method.png "Metodology used")

## Objetive
<p align="justify">
This repository has been created to compile a range of segmentations from various public glaucoma datasets. The goal is to provide users with the ability to compare their own models with these segmentations. The repository contains segmentations generated by our Teacher model, which can be found in the Teacher folder. Additionally, we have included segmentations generated by two Student models - one that was trained with only the AIROGS pseudo labels (Student_Fu), and another that was trained using both AIROGS and S (Student_Fsuu). Each folder has the segmentation of each test set (see the Table below). Both binary segmentations and score maps are available for each dataset. It is important to note that only the Teacher model contains the AIROGS segmentation as the Student models were trained with those segmentations.
</p>

The public datasets used in the test are listed in the table below.



| Dataset    | Number of samples | 
|:----------:|:-----------------:|
| BOSCH      | 41    |
| FORUS      | 31    |
| REMIDIO    | 264   |
| DRISHTI    | 50    |
| REFUGE     | 400   |
| RIM ONE v3 | 159   |
| ORIGA      | 647   |
| PALM       | 400   |
| AIROGS     | 18000 |




## Citation

```
@inproceedings{moris2024semi,
  title={Semi-supervised learning with Noisy\~{} Students improves domain generalization in optic disc and cup segmentation in uncropped fundus images},
  author={Moris, Eugenia and Larrabide, Ignacio and Orlando, Jos{\'e} Ignacio},
  booktitle={Medical Imaging with Deep Learning},
  year={2024}
}
```

## Contact

email: emoris@pladema.exa.unicen.edu.ar

web: [Yatiris Group](https://yatiris.github.io/people/eugenia_moris/index.html)


